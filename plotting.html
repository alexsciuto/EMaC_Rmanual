<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Plotting | The EMaC R Manual</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.17.2 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Plotting | The EMaC R Manual" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Plotting | The EMaC R Manual" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Alex Sciuto" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction-to-data-wrangling.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> How to Install R</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction to Programming in R</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#variables-in-r"><i class="fa fa-check"></i><b>2.1</b> Variables in R</a><ul>
<li class="chapter" data-level="2.1.1" data-path="intro.html"><a href="intro.html#numeric"><i class="fa fa-check"></i><b>2.1.1</b> Numeric</a></li>
<li class="chapter" data-level="2.1.2" data-path="intro.html"><a href="intro.html#character"><i class="fa fa-check"></i><b>2.1.2</b> Character</a></li>
<li class="chapter" data-level="2.1.3" data-path="intro.html"><a href="intro.html#logical"><i class="fa fa-check"></i><b>2.1.3</b> Logical</a></li>
<li class="chapter" data-level="2.1.4" data-path="intro.html"><a href="intro.html#vector"><i class="fa fa-check"></i><b>2.1.4</b> Vector</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#logical-operators"><i class="fa fa-check"></i><b>2.2</b> Logical Operators</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introduction-to-data-wrangling.html"><a href="introduction-to-data-wrangling.html"><i class="fa fa-check"></i><b>3</b> Introduction to Data Wrangling</a><ul>
<li class="chapter" data-level="3.1" data-path="introduction-to-data-wrangling.html"><a href="introduction-to-data-wrangling.html#the-study"><i class="fa fa-check"></i><b>3.1</b> The study</a></li>
<li class="chapter" data-level="3.2" data-path="introduction-to-data-wrangling.html"><a href="introduction-to-data-wrangling.html#loading-in-data"><i class="fa fa-check"></i><b>3.2</b> Loading in Data</a><ul>
<li class="chapter" data-level="3.2.1" data-path="introduction-to-data-wrangling.html"><a href="introduction-to-data-wrangling.html#loading-packages"><i class="fa fa-check"></i><b>3.2.1</b> Loading Packages</a></li>
<li class="chapter" data-level="3.2.2" data-path="introduction-to-data-wrangling.html"><a href="introduction-to-data-wrangling.html#setting-the-working-directory"><i class="fa fa-check"></i><b>3.2.2</b> setting the working directory</a></li>
<li class="chapter" data-level="3.2.3" data-path="introduction-to-data-wrangling.html"><a href="introduction-to-data-wrangling.html#reading-in-data"><i class="fa fa-check"></i><b>3.2.3</b> Reading in Data</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="introduction-to-data-wrangling.html"><a href="introduction-to-data-wrangling.html#dplyr-package"><i class="fa fa-check"></i><b>3.3</b> Dplyr() Package</a><ul>
<li class="chapter" data-level="3.3.1" data-path="introduction-to-data-wrangling.html"><a href="introduction-to-data-wrangling.html#select"><i class="fa fa-check"></i><b>3.3.1</b> select()</a></li>
<li class="chapter" data-level="3.3.2" data-path="introduction-to-data-wrangling.html"><a href="introduction-to-data-wrangling.html#group_by-summarise"><i class="fa fa-check"></i><b>3.3.2</b> group_by() &amp; summarise()</a></li>
<li class="chapter" data-level="3.3.3" data-path="introduction-to-data-wrangling.html"><a href="introduction-to-data-wrangling.html#arrange"><i class="fa fa-check"></i><b>3.3.3</b> arrange()</a></li>
<li class="chapter" data-level="3.3.4" data-path="introduction-to-data-wrangling.html"><a href="introduction-to-data-wrangling.html#filter"><i class="fa fa-check"></i><b>3.3.4</b> filter()</a></li>
<li class="chapter" data-level="3.3.5" data-path="introduction-to-data-wrangling.html"><a href="introduction-to-data-wrangling.html#mutate"><i class="fa fa-check"></i><b>3.3.5</b> mutate()</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="plotting.html"><a href="plotting.html"><i class="fa fa-check"></i><b>4</b> Plotting</a><ul>
<li class="chapter" data-level="4.0.1" data-path="plotting.html"><a href="plotting.html#ggplot-grammar"><i class="fa fa-check"></i><b>4.0.1</b> ggplot grammar</a></li>
<li class="chapter" data-level="4.0.2" data-path="plotting.html"><a href="plotting.html#example-scatterplot-grammar"><i class="fa fa-check"></i><b>4.0.2</b> Example: Scatterplot Grammar</a></li>
<li class="chapter" data-level="4.0.3" data-path="plotting.html"><a href="plotting.html#example-histogram-grammar"><i class="fa fa-check"></i><b>4.0.3</b> Example: Histogram Grammar</a></li>
<li class="chapter" data-level="4.0.4" data-path="plotting.html"><a href="plotting.html#example-density-grammar"><i class="fa fa-check"></i><b>4.0.4</b> Example: Density Grammar</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The EMaC R Manual</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="plotting" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> Plotting</h1>
<p>Now that we have a basic understanding of how to wrangle data, now we want to graphically explain the data we are wrangling. For this chapter we will be using <code>ggplot</code> package to further understand the data. However, before we go into plotting specific things about the data, we need to learn the grammar of plotting with <code>ggplot</code> in general</p>
<div id="ggplot-grammar" class="section level3">
<h3><span class="header-section-number">4.0.1</span> ggplot grammar</h3>
<p>You can think of the grammar of graphics as a systematic approach for describing the components of a graph. It has seven components (the ones in bold are required to be specifed explicitly in ggplot2):</p>
<ul>
<li><strong><em>Data</em></strong>
<ul>
<li>data that you’re feeding into a plot.</li>
</ul></li>
<li><strong><em>Aesthetic mappings</em></strong>
<ul>
<li>How are variables (columns) from your data connect to a visual dimension? Horizontal positioning, vertical positioning, size, colour, shape, etc. These visual dimensions are called “aesthetics”</li>
</ul></li>
<li><strong><em>Geometric objects</em></strong>
<ul>
<li>What are the objects that are actually drawn on the plot? A point, a line, a bar, a histogram, a density, etc.</li>
</ul></li>
<li>Scales
<ul>
<li>How is a variable mapped to its aesthetic? Will it be mapped linearly? On a log scale? Something else? This includes things like the color scale e.g., c(control, treatment_1, treatment_2) -&gt; c(“blue”, “green”, “red”)</li>
</ul></li>
<li>Statistical transformations
<ul>
<li>Whether and how the data are combined/transformed before being plotted e.g., in a bar chart, data are transformed into their frequencies; in a box-plot, data are transformed to a five-number summary.</li>
</ul></li>
<li>Coordinate system
<ul>
<li>This is a specification of how the position aesthetics (x and y) are depicted on the plot. For example, rectangular/cartesian, or polar coordinates.</li>
</ul></li>
<li>Facet
<ul>
<li>This is a specification of data variables that partition the data into smaller “sub plots”, or panels. These components are like parameters of statistical graphics, defining the “space” of statistical graphics. In theory, there is a one-to-one mapping between a plot and its grammar components, making this a useful way to specify graphics.</li>
</ul></li>
</ul>
</div>
<div id="example-scatterplot-grammar" class="section level3">
<h3><span class="header-section-number">4.0.2</span> Example: Scatterplot Grammar</h3>
<p>Let us say that we are interested in how specific word properties relate to one another, and how correlated they are. With this information we can learn specific detials about the nature of our linguistic stimuli, which is very important in psycholinguistics. So for this example we are going to plot the orthographic neighborhood size of the target word and word frequency.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mydata <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> OrthoN_T, <span class="dt">y =</span> Freq_T)) <span class="op">+</span><span class="st"> </span><span class="co"># this defines the x and y axes of the plot</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="co"># this adds geometric objects</span>
<span class="st">  </span><span class="kw">theme_update</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>)) <span class="op">+</span><span class="st"> </span><span class="co"># this line centers the title</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Orthographic Neighborhood Size of Target Word&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="co"># this line sets the label for x-axis</span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Word Frequency of Target Word&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="co"># this line sets the label for y-axis</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Word Frequency and Orthographic Neighborhood Size Scatter Plot&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="co"># this sets the title for the plot </span>
<span class="st">  </span><span class="kw">theme_classic</span>() <span class="co"># this sets the theme for the plot</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<table>
<thead>
<tr class="header">
<th align="center">Grammar Component</th>
<th align="center">Specification</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">data</td>
<td align="center">mydata</td>
</tr>
<tr class="even">
<td align="center">aesthetic mapping</td>
<td align="center">x: OrthoN_T, y: Freq_T</td>
</tr>
<tr class="odd">
<td align="center">geometric object</td>
<td align="center">points</td>
</tr>
<tr class="even">
<td align="center">scale</td>
<td align="center">x: linear, y: linear</td>
</tr>
<tr class="odd">
<td align="center">statistical transform</td>
<td align="center">none</td>
</tr>
<tr class="even">
<td align="center">coordinate system</td>
<td align="center">rectangular</td>
</tr>
<tr class="odd">
<td align="center">facetting</td>
<td align="center">none</td>
</tr>
</tbody>
</table>
</div>
<div id="example-histogram-grammar" class="section level3">
<h3><span class="header-section-number">4.0.3</span> Example: Histogram Grammar</h3>
<p>Useful for depicting the distribution of a continuous random variable. Partitions the number line into bins of certain width, counts the number of observations falling into each bin, and erects a bar of that height for each bin.</p>
<p>Required aesthetics:</p>
<ul>
<li><code>x</code>: A numeric vector.</li>
<li><p>By default, a histogram plots the count on the y-axis. If you want to use proportion (i.e., “density”), specify the y = ..density.. aesthetic.</p></li>
<li>You can change the smoothness of the plot via two arguments (your choice):</li>
<li><code>bins</code>: the number of bins/bars shown in the plot.</li>
<li><p><code>binwidth</code>: the with of the bins shown on the plot.</p></li>
</ul>
<p>Let us say that we want to ask very, very specific questions about how some word properties relate to other word properties. For example, in this experiment we change one letter for a given letter position. for example (word-work) pair manipulates the 4th letter position while (worm-dorm) pair manipulates the 1rst letter position. Let us explore if the words in a particular letter position category vary in word frequency. The way we can do this is by using the <code>facet_grid()</code> function in <code>ggplot</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mydata <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Freq_T)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">20</span>, <span class="dt">alpha =</span> .<span class="dv">7</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Word Frequency of Target Word&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Count&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Word Frequency Distribution for Target Words&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">facet_grid</span>(<span class="op">~</span>probe_position) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_classic</span>() </code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
</div>
<div id="example-density-grammar" class="section level3">
<h3><span class="header-section-number">4.0.4</span> Example: Density Grammar</h3>
<p>Essentially, a “smooth” version of a histogram. Uses kernels to produce the curve.</p>
<p>Required aesthetics:</p>
<ul>
<li><p><code>x</code>: A numeric vector. Good to know:</p></li>
<li><p><code>bw</code> argument controls the smoothness: Smaller = rougher.</p></li>
</ul>
<p>Let us say that we want to explore the same question from before, but we felt like the last graphic wasn’t as clear as we would want it to be. We could use a different graphing strategy such as the density plot to make it clearer to whoever is intepreting the data. Data is only as good as you can communicate and understand it. Observe the differences between the last code’s output and this code’s output</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mydata <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Freq_T)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_density</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> <span class="kw">factor</span>(probe_position), <span class="dt">alpha =</span> <span class="fl">0.05</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Word Frequency of Target Word&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Count&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Word Frequency Distribution for Target Words&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">scale_fill_discrete</span>(<span class="dt">name =</span> <span class="st">&quot;Probe Position&quot;</span>, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;4&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_classic</span>() </code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>




</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction-to-data-wrangling.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/03-method.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
